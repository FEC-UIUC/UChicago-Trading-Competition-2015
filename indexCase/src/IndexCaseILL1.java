
import org.uchicago.index.core.AbstractIndexCase;
import org.uchicago.index.core.IndexCase;

import com.optionscity.freeway.api.IDB;
import com.optionscity.freeway.api.IJobSetup;

import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedList;


public class IndexCaseILL1 extends AbstractIndexCase implements IndexCase {

    int round;

    double score = 0;

    double[] my_portfolioWeights;
    double[] trueWeights;
    double[] last_prices;
    double last_index;

    int substitution_window = 10;
    int min_corr_window = 50;
    double historical_weight = 0.3;

    double[][] historical_correlations;
    double[]   lastUnderlyingPrices = new double[30];
    double[][] returns_history = new double[30][10000];

    LinkedList<Transfer> pendingTransfers = new LinkedList<Transfer>();
    HashMap<Integer, Substitution> currentSubstitutions = new HashMap<Integer, Substitution>();
    HashMap<Integer, Integer> ticksUntilTradable = new HashMap<Integer, Integer>();

    @Override
    public double[] initalizePosition(double[] underlyingPrices, double indexValue, double[] trueWeights, boolean[] tradables) {
        last_prices = underlyingPrices.clone();
        last_index = indexValue;
        this.trueWeights = trueWeights.clone();
        this.my_portfolioWeights = trueWeights.clone();
        regulationAnnouncement(0, 1, tradables);
        my_portfolioWeights = updatePosition(0, underlyingPrices, indexValue);
        return my_portfolioWeights;
    }

    @Override
    public double[] updatePosition(int currentTime, double[] underlyingPrices, double indexValue) {

        /* update price history */
        for(int sec = 0; sec < 30; sec++) {
            if (currentTime > 0) {
                returns_history[sec][currentTime] = (underlyingPrices[sec] - lastUnderlyingPrices[sec]) / lastUnderlyingPrices[sec];
            }
            lastUnderlyingPrices[sec] = underlyingPrices[sec];
            if(ticksUntilTradable.get(sec) > 0) {
                int x = ticksUntilTradable.get(sec);
                ticksUntilTradable.put(sec, --x);
            }
        }

        for (Iterator<Transfer> it = pendingTransfers.iterator(); it.hasNext();) {
            Transfer t = it.next();

            //if(t.remaining == 0){
            //    continue;
            //}

            //log("Will be Transferring " + t.weight + "from " + t.security + " to " + t.substitute + " and remaining = " + t.remaining + " and sw=" + t.sub_window);

            if (--t.remaining < t.sub_window) {
                //log("Transferring " + t.weight + " from " + t.security + " to " + t.substitute);
                my_portfolioWeights[t.substitute] += t.weight;
                my_portfolioWeights[t.security] -= t.weight;
                score -= (Math.exp(Math.abs(t.weight))-1) / 200;
                //log("Weight is now " + my_portfolioWeights[t.security]);
            }

            if(my_portfolioWeights[t.security] < 10e-8){
                my_portfolioWeights[t.security] = 0;
            }
            if(my_portfolioWeights[t.substitute] < 10e-8){
                my_portfolioWeights[t.substitute] = 0;
            }

            if(t.remaining == 0){
                it.remove();
            }

        }

        for (Iterator<Transfer> it = pendingTransfers.iterator(); it.hasNext();) {
            Transfer t = it.next();
            if(t.remaining == 0){
                it.remove();
            }
        }

        //for(int sec = 0; sec < 30; sec++) {
        //    if(ticksUntilTradable.get(sec) != 0 && my_portfolioWeights[sec] > 0){
        //        //log(Integer.toString(sec) + " is banned and we tried wieght " + my_portfolioWeights[sec]);
        //    }
        //}

        double lpv = 0;
        double cpv = 0;
        for(int sec = 0; sec < 30; sec++) {
            lpv += last_prices[sec] * my_portfolioWeights[sec];
            cpv += underlyingPrices[sec] * my_portfolioWeights[sec];
            //log("" + underlyingPrices[sec] + " * " + my_portfolioWeights[sec]);
        }

        double plr = Math.log(cpv/lpv);
        double ilr = Math.log(indexValue/last_index);

        score -= (ilr-plr)*(ilr-plr);

        last_prices = underlyingPrices.clone();

        //log("r_diff=" + ((ilr-plr)*(ilr-plr)) );
        //log("i_r= " + ilr );
        //log("p_r= " + plr );
        //log("i=" + indexValue);
        //log("p=" + cpv);
        log("score = " + score);

        last_index = indexValue;

        return my_portfolioWeights;
    }



    @Override
    public void regulationAnnouncement(int currentTime, int timeTakeEffect, boolean[] tradables) {

        //log("Received announcement at tick " + currentTime + " taking effect at " + timeTakeEffect);
        double[][] correlation_matrix;

        for(int sec = 0; sec < 30; sec++) {
            int tut = ticksUntilTradable.get(sec);
            if (tut == -1 && tradables[sec]) {
                ticksUntilTradable.put(sec, 20);
            }
            else if (!tradables[sec]) {
                ticksUntilTradable.put(sec, -1);
            }
        }

        if(currentTime >= min_corr_window){
            double[][] temp_corr_matrix = computeCorrelationMatrix(currentTime);
            correlation_matrix = addMatrices(historical_correlations, temp_corr_matrix, historical_weight);
        } else {
            correlation_matrix = addMatrices(historical_correlations, new double[30][30], 1.0);
        }


        /* for each security */
        for(int sec = 0; sec < 30; sec++) {

            int substitute = sec;
            while(!tradables[substitute]) {
                correlation_matrix[sec][substitute] = -5;
                substitute = findBestSubstitute(correlation_matrix, sec);
            }

            Substitution cur_sub = currentSubstitutions.get(sec);

            if(tradables[cur_sub.substitute] && !tradables[sec]){
                continue;
            }

            if(substitute != cur_sub.substitute) {
                //log("" + substitute + " subs for " + cur_sub.substitute + " and covers " + sec);
                int tut = ticksUntilTradable.get(substitute);
                int remaining = timeTakeEffect - currentTime;
                if(tut > 0) {
                    remaining++;
                }
                int transactions = (sec == substitute) ? 1 : Math.min(substitution_window, remaining - tut);
                double weight = trueWeights[sec] / Math.min(transactions, remaining);
                //log("tut=" + tut + " for " + substitute);
                //log("transactions=" + transactions);
                Transfer t = new Transfer(cur_sub.substitute, substitute, remaining, transactions, weight);
                Substitution s = new Substitution(sec, substitute, t);
                pendingTransfers.add(t);
                currentSubstitutions.put(sec, s);
            }

        }


    }

    private int findBestSubstitute(double[][] P, int sec) {
        int substitute = -1;
        double max_corr = -1;
        for(int i = 0; i < 30; i++) {
            double corr = P[sec][i];
            if (corr > max_corr) {
                substitute = i;
                max_corr = corr;
            }
        }
        return substitute;
    }

    private double[][] addMatrices(double[][] A, double[][] B, double weight) {
        double[][] C = new double[30][30];

        for(int i = 0; i < 30; i++) {
            for(int j = 0; j < 30; j++) {
                C[i][j] = weight * A[i][j] + (1-weight)*B[i][j];
            }
        }

        return C;
    }

    private double[][] computeCorrelationMatrix(int currentTime){

        /* compute means and variances */
        double[] means = new double[30];
        double[] variances = new double[30];
        for(int sec = 0; sec < 30; sec++) {
            for(int i = 0; i <= currentTime; i++) {
                means[sec] += returns_history[sec][i];
            }
            means[sec] /= currentTime;
            for(int i = 0; i <= currentTime; i++) {
                variances[sec] += (returns_history[sec][i] - means[sec])*(returns_history[sec][i] - means[sec]);
            }
            variances[sec] /= currentTime-1.0;
        }

        /* compute correlation matrix */
        double[][] correlations = new double[30][30];
        for(int s1 = 0; s1 < 30; s1++) {
            for(int s2 = 0; s2 < 30; s2++) {
                for(int i = 0; i < currentTime; i++) {
                    correlations[s1][s2] += (returns_history[s1][i] - means[s1]) * (returns_history[s2][i] - means[s2]);
                }
                correlations[s1][s2] /= (currentTime-1.0) *  Math.sqrt(variances[s1] * variances[s2]);
            }
        }

        return correlations;

    }

    @Override
    public void penaltyNotification(int currentTime, boolean[] tradables) {
        log(Integer.toString(currentTime) + ": Got hit with a penalty. Good one fucker.");
    }

    public IndexCase getImplementation() {
        return this;
    }

    @Override
    public void addVariables(IJobSetup setup) {
        // Registers a variable with the system.
        setup.addVariable("Round", "What round we in, bro?", "int", "1");
        setup.addVariable("substitution window", "What round we in, bro?", "int", "1");
        setup.addVariable("historical weight", "What round we in, bro?", "double", "1.0");
    }

    @Override
    public void initializeAlgo(IDB database) {
        // Databases can be used to store data between rounds

        //log("Initializing algo.");

        round = getIntVar("Round");

        switch(round) {
            case 1:
                substitution_window = 1;
                min_corr_window = 50;
                historical_weight = 0.8;
                historical_correlations = Round1CorrMatrix;
                break;
            case 2:
                substitution_window = 7;
                min_corr_window = 50;
                historical_weight = 0.3;
                historical_correlations = Round2CorrMatrix;
                break;
            case 3:
                substitution_window = 8;
                min_corr_window = 50;
                historical_weight = 0.4;
                historical_correlations = Round3CorrMatrix;
                break;
            default:
                break;
        }

        substitution_window = getIntVar("substitution window");
        historical_weight = getDoubleVar("historical weight");

        /* initialize substitutions */
        for(int sec = 0; sec < 30; sec++) {
            currentSubstitutions.put(sec, new Substitution(sec, sec, null));
            ticksUntilTradable.put(sec, 0);
        }
    }


    public class Transfer {

        public int security;
        public int substitute;
        public int remaining;
        public int sub_window;
        public double weight; //weight to transfer per tick

        public Transfer(int security_, int substitute_, int remaining_, int sub_window_, double weight_) {
            security = security_;
            substitute = substitute_;
            remaining = remaining_;
            sub_window = sub_window_;
            weight = weight_;
        }
    }

    public class Substitution {

        public int security;
        public int substitute;
        private Transfer transfer;

        public Substitution(int security_, int substitute_, Transfer t) {
            security = security_;
            substitute = substitute_;
            transfer = t;
        }

        public Transfer getTransfer() {
            return transfer;
        }

    }


    double[][] Round1CorrMatrix = {
            {1.0,0.0518375540265,0.0858468102131,-0.132375484785,0.0987950775356,0.0746743966634,-0.0192219833044,-0.023048213448,0.0510040243806,0.0161270260979,-0.0669317567791,0.0591246908813,-0.0695146810073,-0.208842999369,0.0475165673032,0.135124999004,0.0488660101603,-0.021322342697,-0.0226640067954,0.0506215232783,0.0424771956799,0.0701715016325,0.0129429091487,0.0323651759973,-0.206279656158,-0.111482574763,0.229964000683,-0.15923514726,0.130946971199,0.0335932443772},
            {0.0518375540265,1.0,-0.0536866508441,-0.0191543091447,-0.0533956894066,-0.217303369466,-0.119682004352,0.0370841210043,0.0289324897342,0.0100313485289,0.0200977509446,0.102710261759,-0.0831384341618,0.178113134682,-0.0524340940065,0.198889729496,-0.0741619588782,-0.164566389014,0.0504678649252,-0.0583856894206,0.0409599259437,0.0454786008791,-0.0818731637754,0.0204561239129,-0.115592370734,0.0594125792671,0.00325373647218,0.0317191954068,-0.183932614537,-0.0294581110986},
            {0.0858468102131,-0.0536866508441,1.0,-0.068501432486,0.113835200785,-0.000589789159995,0.0400283833709,0.0114662589943,-0.13800469706,0.159575050561,-0.0962957000419,-0.15966052017,0.048197587589,0.100451797492,-0.156979576258,-0.00808145658154,0.0706348184946,0.106420097038,0.0478098623486,0.0244896665426,-0.0748263226372,0.0800478422338,0.0169126854574,-0.0307631340746,0.0109759940694,0.0232481465673,0.06892277288,-0.115463374186,-0.180729913734,-0.164386795726},
            {-0.132375484785,-0.0191543091447,-0.068501432486,1.0,-0.0199675689448,-0.0675760565907,0.0922066223327,-0.117279290149,0.0526958593068,0.04810312241,-0.0804808392062,-0.159538842418,-0.00823741240392,-0.204965004936,-0.0464438518268,-0.0838582903247,-0.126738427606,-0.0118911089755,0.0179131099431,-0.139313821209,-0.088799756881,-0.00781370711069,-0.124612791625,-0.0981101901938,0.0379940549018,0.0843043012547,-0.0904847562096,-0.102246437413,-0.0911198270575,-0.0436996664436},
            {0.0987950775356,-0.0533956894066,0.113835200785,-0.0199675689448,1.0,0.0358039808112,-0.0355485653115,-0.0261715341271,0.102054569216,-0.244273596175,-0.102651760862,-0.212595482764,0.0918013025781,0.0561667034643,-0.0786423740827,0.0925142805478,-0.0147423916434,-0.178258579046,0.0104838701616,0.11234354228,0.144067743753,0.0377859530245,0.0267925708476,-0.232723461883,-0.0104104308465,-0.0573636417532,-0.0751369656717,-0.158817512116,0.048062459531,-0.0322625215173},
            {0.0746743966634,-0.217303369466,-0.000589789159995,-0.0675760565907,0.0358039808112,1.0,0.00951031347701,0.00394024652287,0.0190960459695,-0.0749945638691,-0.235708420838,0.000708605184374,0.00391358527983,-0.084924893668,0.0492697211571,0.052634300224,0.0419235377882,-0.128303165332,0.0504055790106,0.0677680398058,-0.152092818166,0.156652733472,-0.000202049248393,0.0810287567434,-0.00267687116427,-0.0554611066833,0.122017339127,-0.0443049488746,-0.078656135025,0.0598283736607},
            {-0.0192219833044,-0.119682004352,0.0400283833709,0.0922066223327,-0.0355485653115,0.00951031347701,1.0,0.162373300074,-0.146385861477,-0.184521265951,0.160259426097,0.150144167848,-0.130990019593,-0.374615168044,-0.019910360405,-0.0188542002949,-0.092141200531,0.0752025517102,-0.0269153448029,0.174050767953,-0.0144366157619,-0.123067684474,-0.121006203023,-0.0535880290065,-0.00192972542214,-0.107331135355,0.152107797765,-0.111313887316,-0.0601079025585,0.0139597793598},
            {-0.023048213448,0.0370841210043,0.0114662589943,-0.117279290149,-0.0261715341271,0.00394024652287,0.162373300074,1.0,-0.103519209629,0.286595495442,-0.0256891935634,0.180937413426,-0.125195456341,-0.0360318007342,-0.146649108193,-0.12373995762,-0.0484490819056,-0.022920102023,0.0527545955117,0.0344184502056,-0.210821546449,0.0732608119509,-0.0721735915485,0.00155802147636,-0.161942320232,0.241653120401,0.132368806464,-0.0411949572815,-0.0895258433712,0.0048261214341},
            {0.0510040243806,0.0289324897342,-0.13800469706,0.0526958593068,0.102054569216,0.0190960459695,-0.146385861477,-0.103519209629,1.0,0.00711008394844,0.0476425060005,0.215852681037,0.102663899614,-0.110297465884,0.0172263888152,-0.0467129412592,-0.0316434285481,-0.0661036291336,0.0218746048341,0.116294800378,-0.149345626186,-0.152184976837,-0.0435849635563,-0.0391311470643,-0.10530302379,0.0128651043147,-0.0584187605647,0.0888950037549,-0.205693852369,-0.138795816505},
            {0.0161270260979,0.0100313485289,0.159575050561,0.04810312241,-0.244273596175,-0.0749945638691,-0.184521265951,0.286595495442,0.00711008394844,1.0,-0.203940825581,0.0236346754385,-0.143458604398,-0.0513844450099,-0.0658227957979,0.083045154708,0.0190253688827,-0.0289314362943,0.0445560452643,-0.11048211345,-0.057975485739,0.0830458447672,-0.0226878481779,0.026678901094,0.0939331871149,0.230334194484,-0.141392604123,-0.0921393127369,-0.063710394265,0.11045309426},
            {-0.0669317567791,0.0200977509446,-0.0962957000419,-0.0804808392062,-0.102651760862,-0.235708420838,0.160259426097,-0.0256891935634,0.0476425060005,-0.203940825581,1.0,0.00920875276969,-0.294878997218,0.122659366901,-0.0794301912404,0.0288725697709,-0.121105187935,0.0789043542381,-0.116443438193,-0.0350782065432,-0.0365601527077,-0.128324544523,0.0569200955703,0.0549440179305,0.0811585101668,-0.00981807159379,0.0686412561126,-0.0733210515053,-0.0984808847011,0.00110114546143},
            {0.0591246908813,0.102710261759,-0.15966052017,-0.159538842418,-0.212595482764,0.000708605184374,0.150144167848,0.180937413426,0.215852681037,0.0236346754385,0.00920875276969,1.0,0.103980138992,-0.152191941291,0.0170842219996,-0.220475210646,-0.140772765056,0.0562029152543,0.179755186032,0.132443074526,-0.00448795252651,-0.138921316024,-0.182613470792,0.117823072018,0.0380499006379,-0.132948654999,0.0609307409399,-0.0774884855753,-0.113296557645,-0.0959519547401},
            {-0.0695146810073,-0.0831384341618,0.048197587589,-0.00823741240392,0.0918013025781,0.00391358527983,-0.130990019593,-0.125195456341,0.102663899614,-0.143458604398,-0.294878997218,0.103980138992,1.0,0.254087543322,0.223995911349,-0.164792866718,0.00669353754581,0.0734040323917,0.033305852282,-0.0567072114981,-0.0365632817542,0.312341066896,-0.000776643172684,0.153143424428,0.173653129691,0.0920920482196,-0.221837537259,0.0103784613537,0.199251742131,-0.0163587459101},
            {-0.208842999369,0.178113134682,0.100451797492,-0.204965004936,0.0561667034643,-0.084924893668,-0.374615168044,-0.0360318007342,-0.110297465884,-0.0513844450099,0.122659366901,-0.152191941291,0.254087543322,1.0,-0.0743122938311,0.331692753332,-0.0809258848671,0.0940578798319,0.289606667769,-0.170522087794,0.12235809705,0.0873798182249,0.0329447385718,0.201267212963,0.100131600198,0.168574053301,-0.00908285448662,0.0172724907066,-0.139875445257,0.120635065916},
            {0.0475165673032,-0.0524340940065,-0.156979576258,-0.0464438518268,-0.0786423740827,0.0492697211571,-0.019910360405,-0.146649108193,0.0172263888152,-0.0658227957979,-0.0794301912404,0.0170842219996,0.223995911349,-0.0743122938311,1.0,-0.234728432735,-0.0910318752573,-0.151006179067,0.0049933458472,0.11252065949,0.0505000255977,-0.0151052179282,-0.130608976705,-0.0168100367729,-0.00449840829378,-0.175676840509,0.0134528675465,-0.0780513938306,0.00445229106748,-0.141226174399},
            {0.135124999004,0.198889729496,-0.00808145658154,-0.0838582903247,0.0925142805478,0.052634300224,-0.0188542002949,-0.12373995762,-0.0467129412592,0.083045154708,0.0288725697709,-0.220475210646,-0.164792866718,0.331692753332,-0.234728432735,1.0,0.177720027489,-0.0470301638645,-0.0756844577841,-0.0853302858272,0.00671091656474,-0.0238552652979,0.00815847265444,0.0903107860579,0.0160692684094,0.0780534635933,0.0566199699056,0.0704423319364,0.102517327014,0.271264047415},
            {0.0488660101603,-0.0741619588782,0.0706348184946,-0.126738427606,-0.0147423916434,0.0419235377882,-0.092141200531,-0.0484490819056,-0.0316434285481,0.0190253688827,-0.121105187935,-0.140772765056,0.00669353754581,-0.0809258848671,-0.0910318752573,0.177720027489,1.0,0.0227113829173,0.00821059564914,0.0184655665603,-0.212022140271,-0.0709181070717,0.0790875666947,0.0609076824181,-0.0423366260892,0.0542837725158,0.0831092128937,0.0308383834038,0.0431852262319,-0.0549748247954},
            {-0.021322342697,-0.164566389014,0.106420097038,-0.0118911089755,-0.178258579046,-0.128303165332,0.0752025517102,-0.022920102023,-0.0661036291336,-0.0289314362943,0.0789043542381,0.0562029152543,0.0734040323917,0.0940578798319,-0.151006179067,-0.0470301638645,0.0227113829173,1.0,0.11643633328,0.0414209020318,-0.119581111061,-0.018034670346,-0.0957286699352,-0.112148261505,0.015164318966,0.0325738152871,0.0883176199152,0.185588475759,-0.168121744258,0.0810069704742},
            {-0.0226640067954,0.0504678649252,0.0478098623486,0.0179131099431,0.0104838701616,0.0504055790106,-0.0269153448029,0.0527545955117,0.0218746048341,0.0445560452643,-0.116443438193,0.179755186032,0.033305852282,0.289606667769,0.0049933458472,-0.0756844577841,0.00821059564914,0.11643633328,1.0,0.048354293161,-0.0927647620221,0.00578877855023,0.0548105679551,0.0663185168638,0.0247179172012,0.212321137667,-0.0524535949171,-0.172125160145,-0.0274884214857,-0.0328722707502},
            {0.0506215232783,-0.0583856894206,0.0244896665426,-0.139313821209,0.11234354228,0.0677680398058,0.174050767953,0.0344184502056,0.116294800378,-0.11048211345,-0.0350782065432,0.132443074526,-0.0567072114981,-0.170522087794,0.11252065949,-0.0853302858272,0.0184655665603,0.0414209020318,0.048354293161,1.0,-0.0437798962087,0.127947581642,0.0408068679491,-0.274248843263,-0.000492765039389,0.199669632615,-0.00452567232364,-0.151198009789,0.0718536559304,-0.0393445998541},
            {0.0424771956799,0.0409599259437,-0.0748263226372,-0.088799756881,0.144067743753,-0.152092818166,-0.0144366157619,-0.210821546449,-0.149345626186,-0.057975485739,-0.0365601527077,-0.00448795252651,-0.0365632817542,0.12235809705,0.0505000255977,0.00671091656474,-0.212022140271,-0.119581111061,-0.0927647620221,-0.0437798962087,1.0,0.146182336613,-0.135328884927,0.0564514798199,0.0343626558129,-0.0718797444966,-0.170634999315,0.0487532593289,0.0520870225779,0.110239225947},
            {0.0701715016325,0.0454786008791,0.0800478422338,-0.00781370711069,0.0377859530245,0.156652733472,-0.123067684474,0.0732608119509,-0.152184976837,0.0830458447672,-0.128324544523,-0.138921316024,0.312341066896,0.0873798182249,-0.0151052179282,-0.0238552652979,-0.0709181070717,-0.018034670346,0.00578877855023,0.127947581642,0.146182336613,1.0,0.0934744632844,0.0717021811749,-0.0650053793821,0.0653722798038,-0.113044210466,-0.0844129326118,-0.114339927572,0.117053606511},
            {0.0129429091487,-0.0818731637754,0.0169126854574,-0.124612791625,0.0267925708476,-0.000202049248393,-0.121006203023,-0.0721735915485,-0.0435849635563,-0.0226878481779,0.0569200955703,-0.182613470792,-0.000776643172684,0.0329447385718,-0.130608976705,0.00815847265444,0.0790875666947,-0.0957286699352,0.0548105679551,0.0408068679491,-0.135328884927,0.0934744632844,1.0,-0.126672565694,-0.0958296568192,0.0453995917675,-0.110792052247,-0.204741204252,0.100027953187,0.173811258285},
            {0.0323651759973,0.0204561239129,-0.0307631340746,-0.0981101901938,-0.232723461883,0.0810287567434,-0.0535880290065,0.00155802147636,-0.0391311470643,0.026678901094,0.0549440179305,0.117823072018,0.153143424428,0.201267212963,-0.0168100367729,0.0903107860579,0.0609076824181,-0.112148261505,0.0663185168638,-0.274248843263,0.0564514798199,0.0717021811749,-0.126672565694,1.0,0.100550724006,-0.0624763938847,0.0518771400202,0.188530613772,-0.173125731992,0.0835266926158},
            {-0.206279656158,-0.115592370734,0.0109759940694,0.0379940549018,-0.0104104308465,-0.00267687116427,-0.00192972542214,-0.161942320232,-0.10530302379,0.0939331871149,0.0811585101668,0.0380499006379,0.173653129691,0.100131600198,-0.00449840829378,0.0160692684094,-0.0423366260892,0.015164318966,0.0247179172012,-0.000492765039389,0.0343626558129,-0.0650053793821,-0.0958296568192,0.100550724006,1.0,-0.0756715174448,-0.0564707313195,0.0130577867979,-0.101081752199,-0.0128687435349},
            {-0.111482574763,0.0594125792671,0.0232481465673,0.0843043012547,-0.0573636417532,-0.0554611066833,-0.107331135355,0.241653120401,0.0128651043147,0.230334194484,-0.00981807159379,-0.132948654999,0.0920920482196,0.168574053301,-0.175676840509,0.0780534635933,0.0542837725158,0.0325738152871,0.212321137667,0.199669632615,-0.0718797444966,0.0653722798038,0.0453995917675,-0.0624763938847,-0.0756715174448,1.0,-0.0634804098323,-0.00752487049966,0.061887236871,0.0548210155589},
            {0.229964000683,0.00325373647218,0.06892277288,-0.0904847562096,-0.0751369656717,0.122017339127,0.152107797765,0.132368806464,-0.0584187605647,-0.141392604123,0.0686412561126,0.0609307409399,-0.221837537259,-0.00908285448662,0.0134528675465,0.0566199699056,0.0831092128937,0.0883176199152,-0.0524535949171,-0.00452567232364,-0.170634999315,-0.113044210466,-0.110792052247,0.0518771400202,-0.0564707313195,-0.0634804098323,1.0,0.0595734209546,0.024601455872,0.0924245653032},
            {-0.15923514726,0.0317191954068,-0.115463374186,-0.102246437413,-0.158817512116,-0.0443049488746,-0.111313887316,-0.0411949572815,0.0888950037549,-0.0921393127369,-0.0733210515053,-0.0774884855753,0.0103784613537,0.0172724907066,-0.0780513938306,0.0704423319364,0.0308383834038,0.185588475759,-0.172125160145,-0.151198009789,0.0487532593289,-0.0844129326118,-0.204741204252,0.188530613772,0.0130577867979,-0.00752487049966,0.0595734209546,1.0,-0.0205207039916,-0.132529820774},
            {0.130946971199,-0.183932614537,-0.180729913734,-0.0911198270575,0.048062459531,-0.078656135025,-0.0601079025585,-0.0895258433712,-0.205693852369,-0.063710394265,-0.0984808847011,-0.113296557645,0.199251742131,-0.139875445257,0.00445229106748,0.102517327014,0.0431852262319,-0.168121744258,-0.0274884214857,0.0718536559304,0.0520870225779,-0.114339927572,0.100027953187,-0.173125731992,-0.101081752199,0.061887236871,0.024601455872,-0.0205207039916,1.0,0.141367765869},
            {0.0335932443772,-0.0294581110986,-0.164386795726,-0.0436996664436,-0.0322625215173,0.0598283736607,0.0139597793598,0.0048261214341,-0.138795816505,0.11045309426,0.00110114546143,-0.0959519547401,-0.0163587459101,0.120635065916,-0.141226174399,0.271264047415,-0.0549748247954,0.0810069704742,-0.0328722707502,-0.0393445998541,0.110239225947,0.117053606511,0.173811258285,0.0835266926158,-0.0128687435349,0.0548210155589,0.0924245653032,-0.132529820774,0.141367765869,1.0}
    };

    double[][] Round2CorrMatrix = {
            {1.0,0.0161226193125,0.00959415456802,0.148226025009,-0.00973904339949,0.00382255534505,0.62730226299,-0.000726520631146,0.00929855542194,0.000339405620455,-0.00984454156686,0.00600338659317,-0.0009914524331,0.00706748411984,-0.00664201764297,0.00786769840299,0.0185975360537,-0.0150388410606,0.00164313073058,-0.000748541589343,0.00729113634097,0.013029227389,-0.00942037110382,0.653791668891,-0.00364296960012,0.0041203138283,-0.0136768199048,0.590460725294,0.00330569793588,0.00386480451834},
            {0.0161226193125,1.0,-0.00739835373024,0.021812073678,-0.00763856711082,-0.0132619658331,0.00854914035775,-0.00635663106111,0.180240660734,0.00615226791313,-0.00745024548286,-0.00623930333221,0.000130195884043,0.00564739010229,-0.00530610447532,0.291050083452,0.113560181395,-0.00361252251219,-0.0100419155125,-0.0134289572133,-0.00688369306529,0.237215887127,-0.0016495142479,0.0115308882982,-0.0102993319954,0.00336318596307,-0.0134218084566,0.0110270874335,0.000387486367813,-0.0109256733048},
            {0.00959415456802,-0.00739835373024,1.0,0.0188571831845,0.0121218502211,-0.00334880974993,-0.00366455790802,0.00738658738943,-0.00796598511372,0.0130323765561,0.0134488295537,0.00104597260987,0.0075438617437,0.0143030555588,-0.023315128694,-0.00759570247362,-0.00445367042858,0.00344972326308,0.0121225892437,0.0176240151711,0.00883126494364,-0.00427396753292,0.00611064193116,-0.00214950366641,0.0146855136891,-0.00552054308739,0.102457986862,0.0139958329823,-0.00904670897185,0.151281353772},
            {0.148226025009,0.021812073678,0.0188571831845,1.0,0.00737443704938,0.00808763975623,0.225677900746,-0.00643412511298,0.00125122551236,0.00849814173739,0.000778019658834,-0.00209294933241,-0.00702037438525,0.00229331406273,-0.00195941009654,0.00236948165045,-0.000425901257728,-0.0118800908388,0.01127006231,-0.000230847225346,0.00150761585912,-0.00560936491251,0.00457030955118,0.238894732595,0.00397777909084,0.0196890775607,-0.00718271966964,0.230852398435,0.00427996798372,0.0137545176418},
            {-0.00973904339949,-0.00763856711082,0.0121218502211,0.00737443704938,1.0,0.304719178622,-0.012920369836,-0.0159452764465,0.00615743972521,0.538493588211,-0.000888624165837,0.00730456352496,-0.0168609995197,0.00661500661748,-0.00244858710802,-0.00814289186517,-0.0109373933044,-0.0111276814833,-0.0176377910671,0.0108746434342,0.517379756678,-0.0140718029807,0.371296999103,-0.0136282671443,-0.00721223597289,-0.00769339489027,-4.99061501063e-05,-0.0179531525182,-0.0151491833209,0.0162227159337},
            {0.00382255534505,-0.0132619658331,-0.00334880974993,0.00808763975623,0.304719178622,1.0,-0.00545002725734,-0.00482876307723,-0.0184487880587,0.469407792251,-0.00852214985232,0.00856647221144,-0.00696880557484,-0.00881369449246,-0.00292860977389,-0.0140413451767,-0.0128778023558,-0.0139429039649,-0.00577156893669,0.00492623130971,0.456231935458,-0.0111339636568,0.321895517014,-0.00210871435155,-0.00956047107181,-0.0168056309032,0.0188883506029,-0.00376788791064,-0.00190964568722,0.00909525486534},
            {0.62730226299,0.00854914035775,-0.00366455790802,0.225677900746,-0.012920369836,-0.00545002725734,1.0,-0.00671158177416,0.0112431573011,0.000527096821753,-0.00395337553602,0.000631076033449,0.000267244039902,-0.00437260153415,-0.00482988971853,0.0137257287868,-0.0055948108606,-0.0198611394695,0.00603044877685,-0.00743777076159,-0.00189189702337,0.0119976561404,0.000550838520195,0.912910512188,-0.0133537791933,0.004243068138,0.00140740502567,0.823286430279,-0.00831811627488,0.0103122360983},
            {-0.000726520631146,-0.00635663106111,0.00738658738943,-0.00643412511298,-0.0159452764465,-0.00482876307723,-0.00671158177416,1.0,-0.00295650489413,-0.00801556823292,-0.00324038850786,0.00348905498076,0.803269748241,0.014111020166,-0.0186831330895,0.00532179989502,0.0126376916482,0.663458600855,-0.00662308959605,-0.0120988521302,-0.00772578113666,0.00892563354961,-0.00973012149072,-0.00460813561874,-0.00271258389867,0.346132332899,0.018935126625,-0.00382296391422,0.6098194602,0.0120876746519},
            {0.00929855542194,0.180240660734,-0.00796598511372,0.00125122551236,0.00615743972521,-0.0184487880587,0.0112431573011,-0.00295650489413,1.0,0.00214365796715,-0.00351963584645,-0.0227801693876,-0.0034070652339,-0.0194926493419,-0.0205071801928,0.643662973934,0.317513068837,0.00295771048123,-0.00506030908975,-0.00491062870992,-0.00242113663275,0.47196678941,-0.00531450057285,0.00424794659187,0.0135759957472,0.00440745265704,-0.0186657170926,0.0101528421641,0.0014034168891,-0.010303644966},
            {0.000339405620455,0.00615226791313,0.0130323765561,0.00849814173739,0.538493588211,0.469407792251,0.000527096821753,-0.00801556823292,0.00214365796715,1.0,-0.0136788716009,0.00496294105512,-0.0186685401543,0.0085812565446,-0.0266807786525,-0.00101686996088,0.00316797623858,-0.0165493730939,0.00452228861446,0.00231680351457,0.812743943706,-0.00183178266174,0.588051401391,0.00290982306054,-0.00984038960493,-0.020163829481,0.00589754046991,-0.00526495874496,-0.0148780601398,0.0140973299284},
            {-0.00984454156686,-0.00745024548286,0.0134488295537,0.000778019658834,-0.000888624165837,-0.00852214985232,-0.00395337553602,-0.00324038850786,-0.00351963584645,-0.0136788716009,1.0,-0.00257363268038,-0.00280231098517,0.00543714448743,0.0177262685774,0.00686931771957,2.50091640567e-05,-0.00959914128174,0.0011114106837,0.0103581217014,-0.00446202923229,0.00917129035517,-0.00349233939888,0.000884896055696,-0.00365137411572,-0.00825230958068,0.0194493251927,-0.00485926637162,-0.00295832165816,-0.00317196379625},
            {0.00600338659317,-0.00623930333221,0.00104597260987,-0.00209294933241,0.00730456352496,0.00856647221144,0.000631076033449,0.00348905498076,-0.0227801693876,0.00496294105512,-0.00257363268038,1.0,0.00126342054895,-0.000485589076698,0.0126320655834,-0.0139629672293,-0.0177296950888,0.010501498681,-0.0153830026606,-0.00106650633903,-0.00681481547405,0.000589674484568,0.0182848513153,-0.0001584788982,0.00699581461084,-0.00879159817049,0.00783041334589,0.00229506302771,0.00189110359971,0.0034572194819},
            {-0.0009914524331,0.000130195884043,0.0075438617437,-0.00702037438525,-0.0168609995197,-0.00696880557484,0.000267244039902,0.803269748241,-0.0034070652339,-0.0186685401543,-0.00280231098517,0.00126342054895,1.0,0.0025640177753,-0.0173982742741,0.00134632623887,0.0129537122686,0.680269788634,0.0103377065441,-0.00643571708562,-0.0119478753201,0.00201646793074,-0.0107690244161,0.00106715186844,-0.00440423671153,0.355498730305,0.0120004187673,0.00278113291771,0.621877951544,0.00266934709224},
            {0.00706748411984,0.00564739010229,0.0143030555588,0.00229331406273,0.00661500661748,-0.00881369449246,-0.00437260153415,0.014111020166,-0.0194926493419,0.0085812565446,0.00543714448743,-0.000485589076698,0.0025640177753,1.0,-0.00914886413954,-0.0161076587368,-0.0102362323488,0.010961011526,0.000376287576053,0.00219315081812,0.00582152410922,-0.0263292764264,-0.000702625073474,0.00289349541523,0.0093424878468,0.0295733337984,0.0146448758563,-0.00457256261402,0.00364907184119,-0.00103943498085},
            {-0.00664201764297,-0.00530610447532,-0.023315128694,-0.00195941009654,-0.00244858710802,-0.00292860977389,-0.00482988971853,-0.0186831330895,-0.0205071801928,-0.0266807786525,0.0177262685774,0.0126320655834,-0.0173982742741,-0.00914886413954,1.0,-0.0119453293057,0.0131186979104,-0.00368664285963,0.00142818559306,0.00248043881739,-0.0179722729343,-0.0219285013984,-0.0210585160132,-0.00627798302937,0.0186820410649,-0.0175172308624,0.00552670317787,-0.0153084471303,-0.00815946283669,-0.00362399220412},
            {0.00786769840299,0.291050083452,-0.00759570247362,0.00236948165045,-0.00814289186517,-0.0140413451767,0.0137257287868,0.00532179989502,0.643662973934,-0.00101686996088,0.00686931771957,-0.0139629672293,0.00134632623887,-0.0161076587368,-0.0119453293057,1.0,0.462745734569,0.0127371852174,0.00104156357638,-0.000467058748491,-0.00703280836199,0.709771684875,0.00604892945213,0.0124324301768,0.00170460209475,-0.00534237111978,0.00531947028691,0.0125775639212,-0.00686637078826,-0.00255407633219},
            {0.0185975360537,0.113560181395,-0.00445367042858,-0.000425901257728,-0.0109373933044,-0.0128778023558,-0.0055948108606,0.0126376916482,0.317513068837,0.00316797623858,2.50091640567e-05,-0.0177296950888,0.0129537122686,-0.0102362323488,0.0131186979104,0.462745734569,1.0,0.0103808452456,0.00585822757681,0.0038105767202,0.00109247002875,0.331010191385,-0.0190043937022,-0.0106469776231,-0.00698223583134,-0.0149827274944,0.00269943963174,-0.00580419601586,0.00734165477802,0.000908512335649},
            {-0.0150388410606,-0.00361252251219,0.00344972326308,-0.0118800908388,-0.0111276814833,-0.0139429039649,-0.0198611394695,0.663458600855,0.00295771048123,-0.0165493730939,-0.00959914128174,0.010501498681,0.680269788634,0.010961011526,-0.00368664285963,0.0127371852174,0.0103808452456,1.0,-0.000265496988087,-0.00434023772443,-0.021766780156,0.011112669308,-0.00790710746835,-0.0130427174181,0.00591431979139,0.291675332779,0.0169060637055,-0.0176668144755,0.513697076502,0.00511961991063},
            {0.00164313073058,-0.0100419155125,0.0121225892437,0.01127006231,-0.0176377910671,-0.00577156893669,0.00603044877685,-0.00662308959605,-0.00506030908975,0.00452228861446,0.0011114106837,-0.0153830026606,0.0103377065441,0.000376287576053,0.00142818559306,0.00104156357638,0.00585822757681,-0.000265496988087,1.0,0.0106901304751,0.0102445618254,-0.00549303189025,-0.00467426119665,0.00382247720376,-0.00302196736942,0.00227741020713,0.0922535722478,0.0160252103527,0.00269673530578,0.122333722258},
            {-0.000748541589343,-0.0134289572133,0.0176240151711,-0.000230847225346,0.0108746434342,0.00492623130971,-0.00743777076159,-0.0120988521302,-0.00491062870992,0.00231680351457,0.0103581217014,-0.00106650633903,-0.00643571708562,0.00219315081812,0.00248043881739,-0.000467058748491,0.0038105767202,-0.00434023772443,0.0106901304751,1.0,-0.00467477447848,0.00306146975349,-0.0100736878372,-0.00123227257711,-0.0236873620234,0.000397221516517,0.0930468630706,0.0109415169638,-0.00344816742071,0.141148556574},
            {0.00729113634097,-0.00688369306529,0.00883126494364,0.00150761585912,0.517379756678,0.456231935458,-0.00189189702337,-0.00772578113666,-0.00242113663275,0.812743943706,-0.00446202923229,-0.00681481547405,-0.0119478753201,0.00582152410922,-0.0179722729343,-0.00703280836199,0.00109247002875,-0.021766780156,0.0102445618254,-0.00467477447848,1.0,-0.00897397558391,0.571344625337,0.00145853251557,-0.000657661603518,-0.01631566204,0.0102545190086,-0.00492244549857,-0.0236746436894,0.0213559732869},
            {0.013029227389,0.237215887127,-0.00427396753292,-0.00560936491251,-0.0140718029807,-0.0111339636568,0.0119976561404,0.00892563354961,0.47196678941,-0.00183178266174,0.00917129035517,0.000589674484568,0.00201646793074,-0.0263292764264,-0.0219285013984,0.709771684875,0.331010191385,0.011112669308,-0.00549303189025,0.00306146975349,-0.00897397558391,1.0,0.0185894856537,0.00937858743774,0.00181249637586,-0.00305239751154,-0.0101947740584,0.0124399005693,-0.00037770222451,-0.00981489752274},
            {-0.00942037110382,-0.0016495142479,0.00611064193116,0.00457030955118,0.371296999103,0.321895517014,0.000550838520195,-0.00973012149072,-0.00531450057285,0.588051401391,-0.00349233939888,0.0182848513153,-0.0107690244161,-0.000702625073474,-0.0210585160132,0.00604892945213,-0.0190043937022,-0.00790710746835,-0.00467426119665,-0.0100736878372,0.571344625337,0.0185894856537,1.0,-0.00371642238172,0.00407810134875,-0.0299471747824,0.00169221778688,-0.00573922545464,-0.026281250389,0.0138806328591},
            {0.653791668891,0.0115308882982,-0.00214950366641,0.238894732595,-0.0136282671443,-0.00210871435155,0.912910512188,-0.00460813561874,0.00424794659187,0.00290982306054,0.000884896055696,-0.0001584788982,0.00106715186844,0.00289349541523,-0.00627798302937,0.0124324301768,-0.0106469776231,-0.0130427174181,0.00382247720376,-0.00123227257711,0.00145853251557,0.00937858743774,-0.00371642238172,1.0,-0.00885124911916,0.00228398106604,-0.00273049989759,0.858248859572,-0.00760855952362,0.00235409913724},
            {-0.00364296960012,-0.0102993319954,0.0146855136891,0.00397777909084,-0.00721223597289,-0.00956047107181,-0.0133537791933,-0.00271258389867,0.0135759957472,-0.00984038960493,-0.00365137411572,0.00699581461084,-0.00440423671153,0.0093424878468,0.0186820410649,0.00170460209475,-0.00698223583134,0.00591431979139,-0.00302196736942,-0.0236873620234,-0.000657661603518,0.00181249637586,0.00407810134875,-0.00885124911916,1.0,0.00914639512875,-0.00338931601057,-0.017881230204,-0.00306042867394,-0.00105120424691},
            {0.0041203138283,0.00336318596307,-0.00552054308739,0.0196890775607,-0.00769339489027,-0.0168056309032,0.004243068138,0.346132332899,0.00440745265704,-0.020163829481,-0.00825230958068,-0.00879159817049,0.355498730305,0.0295733337984,-0.0175172308624,-0.00534237111978,-0.0149827274944,0.291675332779,0.00227741020713,0.000397221516517,-0.01631566204,-0.00305239751154,-0.0299471747824,0.00228398106604,0.00914639512875,1.0,-0.00272748881446,0.00631467430611,0.268640184279,-0.00552926818864},
            {-0.0136768199048,-0.0134218084566,0.102457986862,-0.00718271966964,-4.99061501063e-05,0.0188883506029,0.00140740502567,0.018935126625,-0.0186657170926,0.00589754046991,0.0194493251927,0.00783041334589,0.0120004187673,0.0146448758563,0.00552670317787,0.00531947028691,0.00269943963174,0.0169060637055,0.0922535722478,0.0930468630706,0.0102545190086,-0.0101947740584,0.00169221778688,-0.00273049989759,-0.00338931601057,-0.00272748881446,1.0,-0.00400824274294,0.0112793365951,0.539631045566},
            {0.590460725294,0.0110270874335,0.0139958329823,0.230852398435,-0.0179531525182,-0.00376788791064,0.823286430279,-0.00382296391422,0.0101528421641,-0.00526495874496,-0.00485926637162,0.00229506302771,0.00278113291771,-0.00457256261402,-0.0153084471303,0.0125775639212,-0.00580419601586,-0.0176668144755,0.0160252103527,0.0109415169638,-0.00492244549857,0.0124399005693,-0.00573922545464,0.858248859572,-0.017881230204,0.00631467430611,-0.00400824274294,1.0,-0.00958803445744,0.00907981589252},
            {0.00330569793588,0.000387486367813,-0.00904670897185,0.00427996798372,-0.0151491833209,-0.00190964568722,-0.00831811627488,0.6098194602,0.0014034168891,-0.0148780601398,-0.00295832165816,0.00189110359971,0.621877951544,0.00364907184119,-0.00815946283669,-0.00686637078826,0.00734165477802,0.513697076502,0.00269673530578,-0.00344816742071,-0.0236746436894,-0.00037770222451,-0.026281250389,-0.00760855952362,-0.00306042867394,0.268640184279,0.0112793365951,-0.00958803445744,1.0,-0.00258718543507},
            {0.00386480451834,-0.0109256733048,0.151281353772,0.0137545176418,0.0162227159337,0.00909525486534,0.0103122360983,0.0120876746519,-0.010303644966,0.0140973299284,-0.00317196379625,0.0034572194819,0.00266934709224,-0.00103943498085,-0.00362399220412,-0.00255407633219,0.000908512335649,0.00511961991063,0.122333722258,0.141148556574,0.0213559732869,-0.00981489752274,0.0138806328591,0.00235409913724,-0.00105120424691,-0.00552926818864,0.539631045566,0.00907981589252,-0.00258718543507,1.0}
    };

    double[][] Round3CorrMatrix = {
            {1.0,0.09474400927,0.0832959264072,0.0601069720435,0.111371018102,0.0474267449934,0.120257089537,0.0690104364108,0.0701107485233,0.0389408377357,0.131201426183,0.111691264903,0.120790347346,-0.138807251032,0.120857877402,0.0452282791089,0.00956197583869,0.103990715234,0.04813091356,0.0601567407654,0.157394749996,0.0817302888341,0.109407346403,0.03488000223,0.0299012830173,-0.0314442174545,0.115565187559,0.0548874189202,0.0660262945582,0.0652050476711},
            {0.09474400927,1.0,0.204133063407,0.104258303177,0.288576642,0.0565776151645,0.303543266566,0.136259510109,0.156164254282,0.0957288082981,0.25943833583,0.287099767325,0.243848049154,-0.257708035059,0.221815998565,0.108740819838,0.0620621302842,0.236568175889,0.157347288319,0.106023668925,0.19069826358,0.109142664681,0.238148658679,0.0880132013299,0.0530869291953,-0.0369996182368,0.272210277065,0.109337857618,0.144626893447,0.0915661973767},
            {0.0832959264072,0.204133063407,1.0,0.0847690771149,0.213069586216,0.0416831564403,0.220302702849,0.122036829358,0.125335171138,0.0688132223805,0.148762291418,0.231022286061,0.159038175155,-0.295633386956,0.174376395278,0.0752256417824,0.0425818399794,0.212430957827,0.14152655358,0.0874879786774,0.140089485121,0.0774405956262,0.175451889085,0.0856478280254,0.0350421992379,-0.0695086424326,0.171770031174,0.0894369391244,0.0990058269622,0.0675837084044},
            {0.0601069720435,0.104258303177,0.0847690771149,1.0,0.0939199210442,0.0232474920811,0.1155328754,0.0786939463814,0.0962070494727,0.0501064414462,0.107060270888,0.129022879038,0.0715264100996,-0.200100543212,0.104498393543,0.0282585980088,0.0344821952698,0.15069189187,0.0793234910514,0.0541890609862,0.0557293500351,0.0476407722346,0.085821121118,0.0355407485612,0.0361799329499,-0.0454503450892,0.0931376750333,0.0469821345291,0.0555301873404,0.0454094723836},
            {0.111371018102,0.288576642,0.213069586216,0.0939199210442,1.0,0.0578787804391,0.350445307612,0.143150631614,0.201304016129,0.122117345619,0.325016314691,0.320225816887,0.257227693757,-0.247933956265,0.261038024772,0.147108634773,0.0665297468415,0.277585318504,0.179667940264,0.127279138407,0.27505256696,0.14638237197,0.304295005276,0.0749582431946,0.0584811443069,-0.018201337985,0.357293953035,0.137917459485,0.253450773121,0.116551826826},
            {0.0474267449934,0.0565776151645,0.0416831564403,0.0232474920811,0.0578787804391,1.0,0.085646987748,0.00727257038724,0.033594735298,0.0406013898046,0.0537993375162,0.0652931796244,0.0566034950303,-0.0888046978019,0.0406010557429,0.0393556265461,0.0481996364402,0.0489591680158,0.0289242755092,0.0486508456051,0.0526022171103,0.0362787311071,0.0536361027683,0.0112908575461,0.0410900104393,-0.0317751122703,0.0490456268581,0.0387878028945,0.0355227423624,0.0142547858603},
            {0.120257089537,0.303543266566,0.220302702849,0.1155328754,0.350445307612,0.085646987748,1.0,0.165679733079,0.169373807363,0.131274148767,0.345917284344,0.349517576208,0.248328116734,-0.307726585873,0.266546442622,0.131174082158,0.0697053530028,0.281494137982,0.1655513908,0.144979201795,0.250315262638,0.157810029863,0.334026236685,0.0904138974683,0.0327470093014,-0.0309350487787,0.344010359105,0.162502248482,0.18799571546,0.119948152148},
            {0.0690104364108,0.136259510109,0.122036829358,0.0786939463814,0.143150631614,0.00727257038724,0.165679733079,1.0,0.119906489312,0.0619133539046,0.13626021962,0.147323469534,0.102568864589,-0.181216508541,0.13895471807,0.0705389544786,0.0415013072876,0.13600803047,0.0946992896249,0.0397532139557,0.113727804916,0.0705352363331,0.109660514571,0.0391842301224,0.0334382230412,-0.0210455251603,0.143655623738,0.0893217217474,0.0962615071728,0.0482165868917},
            {0.0701107485233,0.156164254282,0.125335171138,0.0962070494727,0.201304016129,0.033594735298,0.169373807363,0.119906489312,1.0,0.0671045676381,0.130589926038,0.156545990019,0.117139131259,-0.264226593962,0.140242410276,0.0479208821067,0.0486323486218,0.19176353094,0.10975536269,0.107258889021,0.112898390617,0.0925797787482,0.143319090834,0.0303133712558,0.041263710358,-0.0717822599107,0.135970067397,0.0708544573456,0.0700453233329,0.0444604172003},
            {0.0389408377357,0.0957288082981,0.0688132223805,0.0501064414462,0.122117345619,0.0406013898046,0.131274148767,0.0619133539046,0.0671045676381,1.0,0.129018917384,0.0988947088923,0.0877533174074,-0.153275324482,0.105294932923,0.0425437411134,0.0126676548772,0.109315150132,0.0887232201119,0.0516984503935,0.112302671939,0.0571523005157,0.101086359442,0.0344069765211,0.0131613184258,-0.048738570534,0.12700397315,0.0642203060744,0.115840242601,0.0316131072854},
            {0.131201426183,0.25943833583,0.148762291418,0.107060270888,0.325016314691,0.0537993375162,0.345917284344,0.13626021962,0.130589926038,0.129018917384,1.0,0.315637851501,0.246381077961,-0.196954991485,0.249247829595,0.117095052627,0.0663371707911,0.231073848923,0.142791809101,0.12677456762,0.239860232387,0.149962357317,0.288683841756,0.0839757227362,0.0384157055647,-0.0101493719194,0.30847630659,0.144337402532,0.185856696756,0.0979827462114},
            {0.111691264903,0.287099767325,0.231022286061,0.129022879038,0.320225816887,0.0652931796244,0.349517576208,0.147323469534,0.156545990019,0.0988947088923,0.315637851501,1.0,0.223988695386,-0.300488917405,0.235305691182,0.111385599171,0.0518073922179,0.291499347286,0.194719928456,0.128102453428,0.232014680197,0.161374633675,0.279154598077,0.0890939501194,0.064504224627,-0.0456515213216,0.28672234049,0.151026570944,0.188802273471,0.0926975943813},
            {0.120790347346,0.243848049154,0.159038175155,0.0715264100996,0.257227693757,0.0566034950303,0.248328116734,0.102568864589,0.117139131259,0.0877533174074,0.246381077961,0.223988695386,1.0,-0.223802582946,0.277356118543,0.100763055028,0.0498508751066,0.201993137544,0.142171541182,0.121354421483,0.196518353207,0.131454046775,0.249488921558,0.0807636697399,0.0439512260421,-0.0309876092444,0.199310050566,0.110966527609,0.153085809865,0.125283805845},
            {-0.138807251032,-0.257708035059,-0.295633386956,-0.200100543212,-0.247933956265,-0.0888046978019,-0.307726585873,-0.181216508541,-0.264226593962,-0.153275324482,-0.196954991485,-0.300488917405,-0.223802582946,1.0,-0.250893957093,-0.138754383444,-0.0639857479747,-0.325777218553,-0.22014629213,-0.171674161811,-0.223690592399,-0.16340526723,-0.236203295404,-0.0937834852794,-0.0478941440664,0.41750513719,-0.145721455014,-0.117457663908,-0.191466355985,-0.0831765412522},
            {0.120857877402,0.221815998565,0.174376395278,0.104498393543,0.261038024772,0.0406010557429,0.266546442622,0.13895471807,0.140242410276,0.105294932923,0.249247829595,0.235305691182,0.277356118543,-0.250893957093,1.0,0.115769795701,0.0628393031889,0.244273395747,0.160529891253,0.140032269613,0.264821432433,0.129961515066,0.24192465899,0.0684387150115,0.0655936379357,-0.0357347053652,0.228000876997,0.108527365032,0.160306790514,0.132007899472},
            {0.0452282791089,0.108740819838,0.0752256417824,0.0282585980088,0.147108634773,0.0393556265461,0.131174082158,0.0705389544786,0.0479208821067,0.0425437411134,0.117095052627,0.111385599171,0.100763055028,-0.138754383444,0.115769795701,1.0,0.017874382732,0.12278621267,0.026608910486,0.0396565978674,0.113173640433,0.0777514084817,0.0966941579089,0.0336505328689,-0.00504135996189,-0.0240804885577,0.107616785069,0.0608011156689,0.0867536321753,0.0323556242759},
            {0.00956197583869,0.0620621302842,0.0425818399794,0.0344821952698,0.0665297468415,0.0481996364402,0.0697053530028,0.0415013072876,0.0486323486218,0.0126676548772,0.0663371707911,0.0518073922179,0.0498508751066,-0.0639857479747,0.0628393031889,0.017874382732,1.0,0.0522702905528,0.0519513418846,0.0228809111454,0.03381675481,0.010011658478,0.0724875701375,0.0794351486351,0.00476187734386,-0.0219278295345,0.0540399207048,0.00436799465333,0.0452490087729,0.0203216579937},
            {0.103990715234,0.236568175889,0.212430957827,0.15069189187,0.277585318504,0.0489591680158,0.281494137982,0.13600803047,0.19176353094,0.109315150132,0.231073848923,0.291499347286,0.201993137544,-0.325777218553,0.244273395747,0.12278621267,0.0522702905528,1.0,0.178412462893,0.152905195343,0.274901335959,0.168962420551,0.233239648916,0.0759754291296,0.0429488540499,-0.0670401793333,0.24460606715,0.117858438005,0.165199455776,0.0913161263689},
            {0.04813091356,0.157347288319,0.14152655358,0.0793234910514,0.179667940264,0.0289242755092,0.1655513908,0.0946992896249,0.10975536269,0.0887232201119,0.142791809101,0.194719928456,0.142171541182,-0.22014629213,0.160529891253,0.026608910486,0.0519513418846,0.178412462893,1.0,0.0857766391201,0.143725719577,0.0788105187597,0.167314012776,0.0661371554976,0.0450602329197,-0.0668807978327,0.136416279826,0.0780719875678,0.103504781038,0.0589205685823},
            {0.0601567407654,0.106023668925,0.0874879786774,0.0541890609862,0.127279138407,0.0486508456051,0.144979201795,0.0397532139557,0.107258889021,0.0516984503935,0.12677456762,0.128102453428,0.121354421483,-0.171674161811,0.140032269613,0.0396565978674,0.0228809111454,0.152905195343,0.0857766391201,1.0,0.113586397617,0.0738616483265,0.133934898033,-0.0132077380957,-0.0119694714255,-0.0400488995273,0.12948571449,0.0514764040883,0.0788132118996,0.062450918741},
            {0.157394749996,0.19069826358,0.140089485121,0.0557293500351,0.27505256696,0.0526022171103,0.250315262638,0.113727804916,0.112898390617,0.112302671939,0.239860232387,0.232014680197,0.196518353207,-0.223690592399,0.264821432433,0.113173640433,0.03381675481,0.274901335959,0.143725719577,0.113586397617,1.0,0.130421701137,0.23268737817,0.0717321981915,0.0371543951112,-0.0336592101107,0.273978554661,0.109216076549,0.178182613108,0.0835284511517},
            {0.0817302888341,0.109142664681,0.0774405956262,0.0476407722346,0.14638237197,0.0362787311071,0.157810029863,0.0705352363331,0.0925797787482,0.0571523005157,0.149962357317,0.161374633675,0.131454046775,-0.16340526723,0.129961515066,0.0777514084817,0.010011658478,0.168962420551,0.0788105187597,0.0738616483265,0.130421701137,1.0,0.165883109841,-0.00223352643777,0.0171057112515,-0.0385580947332,0.142027829015,0.0644753423517,0.0594271668639,0.0527114798525},
            {0.109407346403,0.238148658679,0.175451889085,0.085821121118,0.304295005276,0.0536361027683,0.334026236685,0.109660514571,0.143319090834,0.101086359442,0.288683841756,0.279154598077,0.249488921558,-0.236203295404,0.24192465899,0.0966941579089,0.0724875701375,0.233239648916,0.167314012776,0.133934898033,0.23268737817,0.165883109841,1.0,0.098112482966,0.0375843063556,-0.0204876081821,0.264344102173,0.155636989429,0.188675823685,0.0900343140432},
            {0.03488000223,0.0880132013299,0.0856478280254,0.0355407485612,0.0749582431946,0.0112908575461,0.0904138974683,0.0391842301224,0.0303133712558,0.0344069765211,0.0839757227362,0.0890939501194,0.0807636697399,-0.0937834852794,0.0684387150115,0.0336505328689,0.0794351486351,0.0759754291296,0.0661371554976,-0.0132077380957,0.0717321981915,-0.00223352643777,0.098112482966,1.0,0.0251403281069,-0.0108934268974,0.0692968402692,0.0270627122255,0.0578295282939,0.0315538385782},
            {0.0299012830173,0.0530869291953,0.0350421992379,0.0361799329499,0.0584811443069,0.0410900104393,0.0327470093014,0.0334382230412,0.041263710358,0.0131613184258,0.0384157055647,0.064504224627,0.0439512260421,-0.0478941440664,0.0655936379357,-0.00504135996189,0.00476187734386,0.0429488540499,0.0450602329197,-0.0119694714255,0.0371543951112,0.0171057112515,0.0375843063556,0.0251403281069,1.0,0.0102313454811,0.0601003892138,0.0242148551888,0.0348362310997,0.0123133224104},
            {-0.0314442174545,-0.0369996182368,-0.0695086424326,-0.0454503450892,-0.018201337985,-0.0317751122703,-0.0309350487787,-0.0210455251603,-0.0717822599107,-0.048738570534,-0.0101493719194,-0.0456515213216,-0.0309876092444,0.41750513719,-0.0357347053652,-0.0240804885577,-0.0219278295345,-0.0670401793333,-0.0668807978327,-0.0400488995273,-0.0336592101107,-0.0385580947332,-0.0204876081821,-0.0108934268974,0.0102313454811,1.0,0.0297062632842,-0.0197432679037,-0.0387404989196,-0.00329531718052},
            {0.115565187559,0.272210277065,0.171770031174,0.0931376750333,0.357293953035,0.0490456268581,0.344010359105,0.143655623738,0.135970067397,0.12700397315,0.30847630659,0.28672234049,0.199310050566,-0.145721455014,0.228000876997,0.107616785069,0.0540399207048,0.24460606715,0.136416279826,0.12948571449,0.273978554661,0.142027829015,0.264344102173,0.0692968402692,0.0601003892138,0.0297062632842,1.0,0.12895601862,0.211410481431,0.0885156078381},
            {0.0548874189202,0.109337857618,0.0894369391244,0.0469821345291,0.137917459485,0.0387878028945,0.162502248482,0.0893217217474,0.0708544573456,0.0642203060744,0.144337402532,0.151026570944,0.110966527609,-0.117457663908,0.108527365032,0.0608011156689,0.00436799465333,0.117858438005,0.0780719875678,0.0514764040883,0.109216076549,0.0644753423517,0.155636989429,0.0270627122255,0.0242148551888,-0.0197432679037,0.12895601862,1.0,0.0962625491622,0.0567395693637},
            {0.0660262945582,0.144626893447,0.0990058269622,0.0555301873404,0.253450773121,0.0355227423624,0.18799571546,0.0962615071728,0.0700453233329,0.115840242601,0.185856696756,0.188802273471,0.153085809865,-0.191466355985,0.160306790514,0.0867536321753,0.0452490087729,0.165199455776,0.103504781038,0.0788132118996,0.178182613108,0.0594271668639,0.188675823685,0.0578295282939,0.0348362310997,-0.0387404989196,0.211410481431,0.0962625491622,1.0,0.0628615726534},
            {0.0652050476711,0.0915661973767,0.0675837084044,0.0454094723836,0.116551826826,0.0142547858603,0.119948152148,0.0482165868917,0.0444604172003,0.0316131072854,0.0979827462114,0.0926975943813,0.125283805845,-0.0831765412522,0.132007899472,0.0323556242759,0.0203216579937,0.0913161263689,0.0589205685823,0.062450918741,0.0835284511517,0.0527114798525,0.0900343140432,0.0315538385782,0.0123133224104,-0.00329531718052,0.0885156078381,0.0567395693637,0.0628615726534,1.0}
    };


}
